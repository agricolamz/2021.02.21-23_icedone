<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Работа с регулярными выражениями | Зимняя школа АйсДан 2021: скрейпинг и анализ текстовых данных</title>
  <meta name="description" content="3 Работа с регулярными выражениями | Зимняя школа АйсДан 2021: скрейпинг и анализ текстовых данных" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Работа с регулярными выражениями | Зимняя школа АйсДан 2021: скрейпинг и анализ текстовых данных" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Работа с регулярными выражениями | Зимняя школа АйсДан 2021: скрейпинг и анализ текстовых данных" />
  
  
  

<meta name="author" content="М. Серветник, Ю. Мартысенко, Г. Мороз, Ф. Управителев" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="работа-со-строками.html"/>
<link rel="next" href="сбор-данных-из-интернета-rvest.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2021 АйсДан</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="работа-со-строками.html"><a href="работа-со-строками.html"><i class="fa fa-check"></i><b>2</b> Работа со строками</a>
<ul>
<li class="chapter" data-level="2.1" data-path="работа-со-строками.html"><a href="работа-со-строками.html#запись-строк"><i class="fa fa-check"></i><b>2.1</b> Запись строк</a></li>
<li class="chapter" data-level="2.2" data-path="работа-со-строками.html"><a href="работа-со-строками.html#количество-символов"><i class="fa fa-check"></i><b>2.2</b> Количество символов</a></li>
<li class="chapter" data-level="2.3" data-path="работа-со-строками.html"><a href="работа-со-строками.html#сортировка"><i class="fa fa-check"></i><b>2.3</b> Сортировка</a></li>
<li class="chapter" data-level="2.4" data-path="работа-со-строками.html"><a href="работа-со-строками.html#конкатенация"><i class="fa fa-check"></i><b>2.4</b> Конкатенация</a></li>
<li class="chapter" data-level="2.5" data-path="работа-со-строками.html"><a href="работа-со-строками.html#работа-с-подстрокой"><i class="fa fa-check"></i><b>2.5</b> Работа с подстрокой</a></li>
<li class="chapter" data-level="2.6" data-path="работа-со-строками.html"><a href="работа-со-строками.html#изменение-строки"><i class="fa fa-check"></i><b>2.6</b> Изменение строки</a></li>
<li class="chapter" data-level="2.7" data-path="работа-со-строками.html"><a href="работа-со-строками.html#пакеты-для-работы-с-текстовыми-данными"><i class="fa fa-check"></i><b>2.7</b> Пакеты для работы с текстовыми данными</a></li>
<li class="chapter" data-level="2.8" data-path="работа-со-строками.html"><a href="работа-со-строками.html#задания"><i class="fa fa-check"></i><b>2.8</b> Задания</a></li>
<li class="chapter" data-level="2.9" data-path="работа-со-строками.html"><a href="работа-со-строками.html#sources"><i class="fa fa-check"></i><b>2.9</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html"><i class="fa fa-check"></i><b>3</b> Работа с регулярными выражениями</a>
<ul>
<li class="chapter" data-level="3.1" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#данные"><i class="fa fa-check"></i><b>3.1</b> Данные</a></li>
<li class="chapter" data-level="3.2" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#регулярные-выражения"><i class="fa fa-check"></i><b>3.2</b> Регулярные выражения</a></li>
<li class="chapter" data-level="3.3" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#символы"><i class="fa fa-check"></i><b>3.3</b> Символы</a></li>
<li class="chapter" data-level="3.4" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#классы-символов"><i class="fa fa-check"></i><b>3.4</b> Классы символов</a></li>
<li class="chapter" data-level="3.5" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#символьные-классы-в-posix"><i class="fa fa-check"></i><b>3.5</b> Символьные классы в POSIX</a></li>
<li class="chapter" data-level="3.6" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#дополнительные-символьные-классы"><i class="fa fa-check"></i><b>3.6</b> Дополнительные символьные классы</a></li>
<li class="chapter" data-level="3.7" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#метасимволы"><i class="fa fa-check"></i><b>3.7</b> Метасимволы</a></li>
<li class="chapter" data-level="3.8" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#квантификаторы"><i class="fa fa-check"></i><b>3.8</b> Квантификаторы</a></li>
<li class="chapter" data-level="3.9" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#логические-операции"><i class="fa fa-check"></i><b>3.9</b> Логические операции</a></li>
<li class="chapter" data-level="3.10" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#якори"><i class="fa fa-check"></i><b>3.10</b> Якори</a></li>
<li class="chapter" data-level="3.11" data-path="работа-с-регулярными-выражениями.html"><a href="работа-с-регулярными-выражениями.html#группы"><i class="fa fa-check"></i><b>3.11</b> Группы</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html"><i class="fa fa-check"></i><b>4</b> Сбор данных из интернета: <code>rvest</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#введение"><i class="fa fa-check"></i><b>4.1</b> Введение</a></li>
<li class="chapter" data-level="4.2" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#работа-с-пакетом-rvest"><i class="fa fa-check"></i><b>4.2</b> Работа с пакетом <code>rvest</code></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#простой-случай"><i class="fa fa-check"></i><b>4.2.1</b> Простой случай</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#использование-циклов"><i class="fa fa-check"></i><b>4.3</b> Использование циклов</a></li>
<li class="chapter" data-level="4.4" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#обкачивание-нескольких-страниц"><i class="fa fa-check"></i><b>4.4</b> Обкачивание нескольких страниц</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#некоторые-советы"><i class="fa fa-check"></i><b>4.4.1</b> Некоторые советы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><i class="fa fa-check"></i><b>5</b> Работа с текстами: <code>gutenbergr</code>, <code>tidytext</code>, <code>stopwords</code>, <code>udpipe</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#загрузка-текста-в-r"><i class="fa fa-check"></i><b>5.1</b> Загрузка текста в R</a></li>
<li class="chapter" data-level="5.2" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#gutenbergr"><i class="fa fa-check"></i><b>5.2</b> <code>gutenbergr</code></a></li>
<li class="chapter" data-level="5.3" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#tidytext-и-stopwords"><i class="fa fa-check"></i><b>5.3</b> <code>tidytext</code> и <code>stopwords</code></a></li>
<li class="chapter" data-level="5.4" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#визуализация-биграмм-с-igraph-и-ggraph"><i class="fa fa-check"></i><b>5.4</b> Визуализация биграмм с <code>igraph</code> и <code>ggraph</code></a></li>
<li class="chapter" data-level="5.5" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#пакет-stopwords"><i class="fa fa-check"></i><b>5.5</b> Пакет <code>stopwords</code></a></li>
<li class="chapter" data-level="5.6" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#пакет-udpipe"><i class="fa fa-check"></i><b>5.6</b> Пакет <code>udpipe</code></a></li>
<li class="chapter" data-level="5.7" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords-udpipe.html#задания-1"><i class="fa fa-check"></i><b>5.7</b> Задания</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="анализ-текста.html"><a href="анализ-текста.html"><i class="fa fa-check"></i><b>6</b> Анализ текста</a>
<ul>
<li class="chapter" data-level="6.1" data-path="анализ-текста.html"><a href="анализ-текста.html#данные-1"><i class="fa fa-check"></i><b>6.1</b> Данные</a></li>
<li class="chapter" data-level="6.2" data-path="анализ-текста.html"><a href="анализ-текста.html#tf-idf"><i class="fa fa-check"></i><b>6.2</b> tf-idf</a></li>
<li class="chapter" data-level="6.3" data-path="анализ-текста.html"><a href="анализ-текста.html#предиктивный-ввод-текста"><i class="fa fa-check"></i><b>6.3</b> Предиктивный ввод текста</a></li>
<li class="chapter" data-level="6.4" data-path="анализ-текста.html"><a href="анализ-текста.html#анализ-тональности"><i class="fa fa-check"></i><b>6.4</b> Анализ тональности</a></li>
<li class="chapter" data-level="6.5" data-path="анализ-текста.html"><a href="анализ-текста.html#тематическое-моделирование"><i class="fa fa-check"></i><b>6.5</b> Тематическое моделирование</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Зимняя школа АйсДан 2021: скрейпинг и анализ текстовых данных</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="работа-с-регулярными-выражениями" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Работа с регулярными выражениями</h1>
<div id="данные" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Данные</h2>
<p>Задача: импортируйте датасет <code>data_ficbook_mass_effect.csv</code>. Создайте копию, в которой не будет колонки <code>text</code>, либо сразу импортируйте без нее.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="работа-с-регулярными-выражениями.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb129-2"><a href="работа-с-регулярными-выражениями.html#cb129-2" aria-hidden="true" tabindex="-1"></a>mass_effect <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;data_ficbook_mass_effect.csv&#39;</span>)</span>
<span id="cb129-3"><a href="работа-с-регулярными-выражениями.html#cb129-3" aria-hidden="true" tabindex="-1"></a>mass_effect_short <span class="ot">&lt;-</span> mass_effect[, .SD, .SDcols <span class="ot">=</span> <span class="sc">-</span><span class="st">&#39;text&#39;</span>]</span></code></pre></div>
</div>
<div id="регулярные-выражения" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Регулярные выражения</h2>
<p>Регулярные выражения (англ. Regular Expressions, regexps)- это специальный язык для описания шаблонов строк, который используется для поиска определенных строк, проверки их на соответствие какому-либо шаблону и другой подобной работы.</p>
<p>Реализация регэкспов в разных языках программирования может различаться, в R используется расширенная версия регулярных выражений (ERE, стандарт POSIX 1003.2) с некоторыми собственными дополнениями, а так же Perl-совместимые регулярные выражения (PCRE 8.36). Согласно стандарту POSIX 1003.2, длина регулярных выражений не может превышать 256 байтов. Впрочем, как показывает практика, с таким ограничением мало кто сталкивается в своей работе.</p>
<p>С регулярными выражениями есть, к сожалению, одна достаточно неприятная особенность - если выражение написано неправильно (в частности, при использовании метасимволов), то в результате, в зависимости от контекста использования, будет либо пропуск нужных элементов, либо просто отсутствие какого-либо эффекта. Поэтому есть смысл упрощать работу с регулярными выражениями, особенно если нет достаточного опыта их использования. Например, разбивать делать изменение части строки в несколько этапов, или же просто тестировать регулярные выражения небольшими блоками.</p>
</div>
<div id="символы" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Символы</h2>
<p>В большинстве своем символы в регулярных выражениях обозначают сами себя, за некоторыми исключениями. Каждый символ в паттерне задает соответствие только одному символу в строке, поэтому в тех случаях, когда необходимо указать какой-то символ из определенного набора или указать, что какой-то символ повторяется некоторое количество раз подряд, следует использовать символьные классы или квантификаторы соответственно.</p>
<p>Если в паттерне указать несколько символов, то поиск по строке будет произведен именно по такому сочетанию символов. Следует учитывать, что некоторые символы или сочетания символов могут быть проинтерпретированы либо как управляющие конструкции регулярных выражений и тогда потребуются дополнительные указания, как должны быть обработаны эти символы.</p>
<p>Во-вторых, некоторые группы символов могут просто иметь дополнительные фиксированные значения. Так, для кодирования перехода на новую строку, табуляции и некоторых других непечатаемых символов используются определенные обозначения: <code>\n</code>, <code>\r</code>, <code>\t</code>, <code>\v</code>, <code>\f</code>. Соответственно, если в строке встретится какое-то из этих сочетаний, то строка будет прочитана и обработана не как строка, содержащая символы обратного слеша и буквы, а как строка с спец.символом (в случае с табуляцией - <code>\t</code>). Особенность парсера R в том, что символ <code>\</code> необходимо дополнительно экранировать, тоже обратным слешом. Это значит, что если в паттерне необходимо использовать <code>\v</code>, то в паттерне регулярных выражений в R он указывается как <code>\\v</code>.</p>
<p>Задача: у вас есть вектор <code>vec &lt;- c('abd', 'bbc', 'ecd', 'ebbba')</code>. С помощью функции <code>gsub()</code> замените все буквы <code>a</code> на символ <code>_</code>.</p>
<p>Решение:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="работа-с-регулярными-выражениями.html#cb130-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;abd&#39;</span>, <span class="st">&#39;bbc&#39;</span>, <span class="st">&#39;ecd&#39;</span>, <span class="st">&#39;eba&#39;</span>)</span>
<span id="cb130-2"><a href="работа-с-регулярными-выражениями.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;_&#39;</span>, vec)</span></code></pre></div>
<pre><code>## [1] &quot;_bd&quot; &quot;bbc&quot; &quot;ecd&quot; &quot;eb_&quot;</code></pre>
<p>Задача: у вас есть вектор <code>vec &lt;- c('abd', 'bbc', 'ecd', 'ebbba')</code>. С помощью функции <code>gsub()</code> замените сочетание <code>bb</code> на символ <code>_</code>.
Решение:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="работа-с-регулярными-выражениями.html#cb132-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;abd&#39;</span>, <span class="st">&#39;bbc&#39;</span>, <span class="st">&#39;ecd&#39;</span>, <span class="st">&#39;ebbba&#39;</span>)</span>
<span id="cb132-2"><a href="работа-с-регулярными-выражениями.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;bb&#39;</span>, <span class="st">&#39;_&#39;</span>, vec)</span></code></pre></div>
<pre><code>## [1] &quot;abd&quot;  &quot;_c&quot;   &quot;ecd&quot;  &quot;e_ba&quot;</code></pre>
<div class="rmdtask">
<p>
С помощью функций <code>grep()</code> / <code>grepl()</code> выберите и посчитайте, в каком количестве строк в колонке <code>link</code> встречается строка <code>source=premium</code>. При желании можете использовать близкие по смыслу функции пакета <code>stringr</code> (<code>str_detect()</code> / <code>str_which()</code>).
</p>
</div>
<!-- Решение:

```r
# data.table
mass_effect[grep('source=premium', link), .N]
```

```
## [1] 11
```

```r
# base R
length(grep('source=premium', mass_effect$link))
```

```
## [1] 11
```
-->
<div class="rmdtask">
<p>
Посчитайте, в каком количестве строк не встречается упоминание Тангейзера.
</p>
</div>
<!-- Решение:

```r
mass_effect[!grepl('Тангейзер', text), .N]
```

```
## [1] 30600
```

```r
sum(!grepl('Тангейзер', mass_effect$text))
```

```
## [1] 30600
```
-->
<div class="rmdtask">
<p>
Из ссылки на пользователя вида <code>/authors/4039177</code> извлеките идентификатор пользователя. Запишите его в колонку <code>author_id</code>.
</p>
</div>
<!-- Решение:

```r
mass_effect[, author_id := as.numeric(gsub('/authors/', '', author_link))]
mass_effect[1:10, list(author, author_id, author_link)]
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["author"],"name":[1],"type":["chr"],"align":["left"]},{"label":["author_id"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["author_link"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Sabi no Kami","2":"7370","3":"/authors/7370"},{"1":"Sabi no Kami","2":"7370","3":"/authors/7370"},{"1":"Sabi no Kami","2":"7370","3":"/authors/7370"},{"1":"Sabi no Kami","2":"7370","3":"/authors/7370"},{"1":"Dillonra","2":"3811888","3":"/authors/3811888"},{"1":"Dillonra","2":"3811888","3":"/authors/3811888"},{"1":"Nemerethe","2":"506335","3":"/authors/506335"},{"1":"Nemerethe","2":"506335","3":"/authors/506335"},{"1":"Nemerethe","2":"506335","3":"/authors/506335"},{"1":"Nemerethe","2":"506335","3":"/authors/506335"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
-->
<div class="rmdtask">
<p>
Выберите текст пролога фанфика ‘Песнь Виктории’ и запишите в новый объект <code>victory_song</code>. Удалите символы переноса строки (чтобы их увидеть, выведите объект на печать).
</p>
</div>
<!-- Решение:

```r
victory_song <- mass_effect[title == 'Песнь Виктории' & subtitle == 'Пролог', text]
victory_song <- gsub('\\r\\n', '', victory_song)
```
-->
<div class="rmdtask">
<p>
Задание повышенной сложности (как минимум, необходимо разобрать кейс): почистите текст так, чтобы <code>2063 года: «Покинуть</code> из первых строчек превратилось в <code>2063 года:______«Покинуть</code>.
</p>
</div>
<!-- Решение:
Решение: в тексте используется неразрывный пробел, при выводе его на печать RStudio его печатает как обычный пробел (хотя в тексте он остается именно неразрывным). Чтобы это увидеть, надо сохранить объект в текстовый файл и открыть его в RStudio, в редакторе - тогда эти символы будут подсвечены красными точками. Можно именно эти точки указать в паттерне, а можно прогнать через `URLencoder()` и посмотреть, что это за символ такой, и потом гуглить,к ак этот символ вычистить в регулярках в R. Так,  неразрывные пробелы можно указать как  `\u00A0` (именно так, тут слэш не экранируется).

```r
victory_song <- gsub('\u00A0', '_', victory_song)
```
-->
</div>
<div id="классы-символов" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Классы символов</h2>
<p>Задачи на поиск конкретного символа с помощью регулярных выражений встречаются, но обычно требуется большая гибкость поиска. Например, не конкретный символ или сочетание символов, а какой-либо символ из набора - знаки пунктуации или же цифры.</p>
<p>Cамостоятельно указать какой-то набор символов можно с помощью квадратных скобок (квадратные скобки как метасимволы регулярных выражений и квадратные скобки в R - это разные конструкции). При этом можно либо просто перечислить все символы набора, либо, если они принадлежат какому-то известному множеству (например, цифры), то указать первый и последний элементы множества через знак дефиса (<code>-</code>). Также можно сочетать сокращенные формы записи наборов символов. Символы кириллического и латинского алфавитов - разные множества, точно также как строчные и прописные буквы.</p>
<p>Внутри классов поведение метасимволов может различаться в зависимости от места их указания в наборе символов класса. Например, <code>^</code> первым символов в наборе символов задает логическое отрицание <code>не из этих символов</code>, и чтобы избежать такого поведения, знак <code>^</code> надо поставить на любое место кроме первого в цепочке. Знак <code>]</code>, если есть необходимость его вкючения в набор символов, наоборот, надо ставить первым в наборе, в противном случае он будет проинтерпретирован как завершение класса. Знак <code>-</code>, если указан не первым и не последним, интерпретируется как знак интервала в известном диапазоне символов (например, <code>[0-9]</code> означает от <code>0</code> до <code>9</code>, а <code>[09-]</code> - символы <code>0</code>, <code>9</code> и <code>-</code>)</p>
<div class="rmdtask">
<p>
Из строки <code>my_string &lt;- ‘D9586bNd879мрЯпп’</code> удалите все цифры.
</p>
</div>
<!-- Решение:

```r
my_string <- 'D9586bNd879мрЯпп'

# перечисление набора цифр
gsub('[0123456789]', '', my_string)
```

```
## [1] "DbNdмрЯпп"
```

```r
# указание набора символов
gsub('[0-9]', '', my_string)
```

```
## [1] "DbNdмрЯпп"
```
-->
<div class="rmdtask">
<p>
Из строки <code>my_string &lt;- ‘D9586bNd879мрЯпп’</code> удалите все цифры и кириллические буквы.
</p>
</div>
<!-- Решение:

```r
# указание набора символов
gsub('[0-9А-Яа-я]', '', my_string)
```

```
## [1] "DbNd"
```
-->
</div>
<div id="символьные-классы-в-posix" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Символьные классы в POSIX</h2>
<p>Стандарт POSIX 1003.2 поддерживает несколько определенных обозначения для часто используемых символьных классов:</p>
<ul>
<li><p><code>[:alnum:]</code>: все буквы и цифры, сочетание символьных классов <code>[:alpha:]</code> и <code>[:digit:]</code>.</p></li>
<li><p><code>[:alpha:]</code>: буквы алфавита в обоих регистрах, для прописных и строчных букв есть отдельные символьные классы: <code>[:lower:]</code> и <code>[:upper:]</code>.</p></li>
<li><p><code>[:punct:]</code>: знаки пунктуации, <code>!"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~.</code>.</p></li>
<li><p><code>[:digit:]</code>: арабские цифры <code>0123456789</code>.</p></li>
<li><p><code>[:xdigit:]</code>: цифры в шестнадцатеричном формате, <code>0123456789ABCDEFabcdef</code>.</p></li>
<li><p><code>[:graph:]</code>: графические знаки, объединенный класс, состоящий из классов <code>[:alnum:]</code> и <code>[:punct:]</code>.</p></li>
<li><p><code>[:print:]</code>: печатаемые знаки, класс <code>[:graph:]</code>, дополненный пробелом.</p></li>
<li><p><code>[:blank:]</code>: непечатаемые символы (пробел, знак табуляции, в зависимости от локали - неразрывный пробел и возможные другие непечатаемые символы).</p></li>
<li><p><code>[:cntrl:]</code>: управляющие символы (в таблицах символов ANSCII коды 000-031 и 121 в десятичной, 000-037 и 177 в восьмеричной системе, 000-07F в шестнадцатеричной системах счислений)</p></li>
<li><p><code>[:space:]</code>: некоторые управляющие символы, которые используются для создания разрывов между символами - пробел, переход на новую строку, возврат каретки, перевод страницы и т.д. В зависимости от локали может содержать дополнительные знаки.</p></li>
</ul>
<p>При указании символьного класса с помощью его имени надо помнить, что обозначение класса также заключается в <code>[]</code>. То есть, вместо <code>[:digit:]</code> (обозначение класса) надо использовать <code>[[:digit:]]</code> (указание символьного класса в рег.выражении):</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="работа-с-регулярными-выражениями.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;[[:digit:]]&#39;</span>, <span class="st">&#39;&#39;</span>, my_string)</span></code></pre></div>
<pre><code>## [1] &quot;DbNdмрЯпп&quot;</code></pre>
</div>
<div id="дополнительные-символьные-классы" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Дополнительные символьные классы</h2>
<p>Помимо обозначений символьных классов, которые поддерживаются стандартом POSIX, также в R реализован ряд собственных символьных классов, которые, как правило, обозначают наиболее часто используемые комбинации:</p>
<ul>
<li><p><code>\\s</code> - пробел</p></li>
<li><p><code>\\S</code>: все знаки, кроме пробела. Аналогично <code>[^[:space:]]</code> или <code>[^\\s]</code></p></li>
<li><p><code>\\d</code>: цифры, аналогично <code>[0-9]</code></p></li>
<li><p><code>\\D</code>: не цифры, обратно <code>\\d</code>, аналогично <code>[^0-9]</code></p></li>
<li><p><code>\\w</code>: символы, которые используются в письме, аналогично <code>[A-z0-9_]</code></p></li>
<li><p><code>\\W</code>: обратный <code>\\w</code> набор, символы, которые не используются в письме</p></li>
</ul>
<div class="rmdtask">
<p>
Из <code>victory_song</code> удалите все знаки препинания (замените на пробел). Попробуйте это сделать как просто с помощью классов символов, так и с помощью POSIX-классов.
</p>
</div>
<!-- Решение:

```r
victory_song <- gsub('[[:punct:]]', ' ', victory_song)
```
-->
<div class="rmdtask">
<p>
Задание повышенной сложности: выберите из <code>victory_song</code> все слова, в которых встречаются заглавные буквы.
</p>
</div>
<!-- Решение:

```r
victory_song_words <- unlist(strsplit(victory_song, '\\s'))
victory_song_words <- grep('[A-ZА-Я]', victory_song_words, value = TRUE)
victory_song_words[1:5]
```

```
## [1] "Постановление" "Верховного"    "Флагмана"      "Ямато"        
## [5] "Покинуть"
```
-->
</div>
<div id="метасимволы" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Метасимволы</h2>
<p>Ряд символов имеет дополнительное значение - эти символы используются не только сами по себе, но и как определенные конструкции языка регулярных выражений. В частности, это символ <code>[</code>, который используется для создания произвольного символьного класса. Полный список выглядит следующим образом:</p>
<ul>
<li><p><code>.</code>: подстановочный знак (wildcard), используется в тех случаях, когда необходимо указать, что на этом месте может быть любой знак</p></li>
<li><p><code>\</code>: используется для экранирования метасимволов</p></li>
<li><p><code>|</code> : логический оператор <code>или</code></p></li>
<li><p><code>(</code> и <code>)</code>: используются для указания групп символов</p></li>
<li><p><code>[</code>: вместе с <code>]</code> используется для указания символьных классов</p></li>
<li><p><code>^</code>: якорь, указывающий на начало строки, а так же логический оператор отрицания, используемый в символьных классах</p></li>
<li><p><code>$</code>: якорь, указывающий на конец строки</p></li>
<li><p><code>*</code>, <code>+</code> и <code>?</code> - квантификаторы, указывающие, что предыдущий символ или группа символов могут или должны повториться некоторое количество раз</p></li>
<li><p><code>{</code>: вместе с <code>}</code> исползуется как квантификатор, указывающий конкретное количество повторений предыдущего символа или группы символов</p></li>
<li><p><code>&lt;</code> и <code>&gt;</code>: используется в Perl-совместимых регулярных выражениях</p></li>
</ul>
<p>Для того, чтобы эти метасимволы воспринимались не как элементы языка регулярных выражений, а как есть, их необходимо экранировать двумя символами <code>\\</code>. Необходимость в двух символах <code>\\</code> для экранирования возникает из-за того, что строковая запись регулярного выражения в R и собственно выражение на языке регулярных выражений несколько различаются.</p>
<div class="rmdtask">
<p>
Удалите из строки <code>metachara.<em>cters</code> символы <code>.</code> и <code></em></code>.
</p>
</div>
<!-- Решение:

```r
# экранируем символы
gsub('\\.\\*', '', 'metachara.*cters')
```

```
## [1] "metacharacters"
```

```r
# если использовать аргумент fixed = TRUE, чтобы паттерн не интерпретировался как регулярка
gsub('.*', '', 'metachara.*cters', fixed = TRUE)
```

```
## [1] "metacharacters"
```
-->
</div>
<div id="квантификаторы" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Квантификаторы</h2>
<p>Для того, чтобы в паттерне указать, что какой-то символ или группа символов может повторяться, используют специальные управляющие знаки - квантификаторы:</p>
<ul>
<li><p><code>?</code>: предыдущий символ или группа символов в паттерне может встречаться 0 или 1 раз. Также вместе с другими квантификаторами используется для нежадного поиска.</p></li>
<li><p><code>*</code>: предыдущий символ или группа символов в паттерне может встречаться 0 или больше раз.</p></li>
<li><p><code>+</code>: предыдущий символ или группа символов в паттерне может встречаться 1 или больше раз.</p></li>
<li><p><code>{n}</code>: предыдущий символ или группа символов может встречаться в паттерно строго <code>n</code> раз.</p></li>
<li><p><code>{n,}</code>: предыдущий символ или группа символов может встречаться в паттерно <code>n</code> и более раз. Конструкции <code>{0,}</code> и <code>{1,}</code> тождественны <code>*</code> и <code>+</code> соответственно.</p></li>
<li><p><code>{n,m}</code>: предыдущий символ или группа символов может встречаться в паттерно <code>n</code> раз, но не более, чем <code>m</code> раз. Конструкции <code>{0,1}</code> и <code>?</code> тождественны.</p></li>
</ul>
<p>Простейший пример использования квантификаторов - когда надо обработать какой-то символ, который встречается несколько раз. Например, скрыть последние четыре цифры в номере телефона:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="работа-с-регулярными-выражениями.html#cb136-1" aria-hidden="true" tabindex="-1"></a>phone_number <span class="ot">&lt;-</span> <span class="st">&#39;my phone number: +7-929-138-5896&#39;</span></span>
<span id="cb136-2"><a href="работа-с-регулярными-выражениями.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;[0-9]{4}&#39;</span>, <span class="st">&#39;XXXX&#39;</span>, phone_number)</span></code></pre></div>
<pre><code>## [1] &quot;my phone number: +7-929-138-XXXX&quot;</code></pre>
<div class="rmdtask">
<p>
В объекте <code>victory_song</code> замените повторяющиеся пробелы на один пробел.
</p>
</div>
<!-- Решение:

```r
victory_song <- gsub('\\s+', ' ', victory_song)
```
-->
</div>
<div id="логические-операции" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Логические операции</h2>
<p>В регулярных выражениях логические операции представлены в достаточно ограниченном виде, можно даже сказать, крайне бедно. Наиболее очевидная из существующих операции - это <code>ИЛИ</code>, когда надо задать несколько вариантов комбинаций символов. В частности, это крайне полезный инструмент для фильтрации вектора строковых значений по определенному критерию. Например, регулярными выражениями с логическим оператором можно просто выделить из списка логов те файлы, которые были созданы в 2015-2016 годах:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="работа-с-регулярными-выражениями.html#cb138-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;log_2014.csv&#39;</span>, <span class="st">&#39;log_2015.csv&#39;</span>, <span class="st">&#39;log_2016.csv&#39;</span>, <span class="st">&#39;log_2017.csv&#39;</span>, <span class="st">&#39;log_2018.csv&#39;</span>)</span>
<span id="cb138-2"><a href="работа-с-регулярными-выражениями.html#cb138-2" aria-hidden="true" tabindex="-1"></a>models[<span class="fu">grep</span>(<span class="st">&#39;2015|2016&#39;</span>, models)]</span></code></pre></div>
<pre><code>## [1] &quot;log_2015.csv&quot; &quot;log_2016.csv&quot;</code></pre>
<p>Второй логический оператор - <code>^</code>, используется в тех случаях, когда надо исключить символы определенного класса. Следует помнить, что <code>^</code> используется в этом значении сугубо внутри <code>[]</code>, в противном случае будет интерпретироваться в другом значении.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="работа-с-регулярными-выражениями.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменяем на &#39;_&#39; любой из символов d, e, f</span></span>
<span id="cb140-2"><a href="работа-с-регулярными-выражениями.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;[def]&#39;</span>, <span class="st">&#39;_&#39;</span>, <span class="st">&#39;fadbcdefghe&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;_a_bc___gh_&quot;</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="работа-с-регулярными-выражениями.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменяем на &#39;_&#39; все, кроме символов d, e, f</span></span>
<span id="cb142-2"><a href="работа-с-регулярными-выражениями.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;[^def]&#39;</span>, <span class="st">&#39;_&#39;</span>, <span class="st">&#39;fadbcdefghe&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;f_d__def__e&quot;</code></pre>
</div>
<div id="якори" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> Якори</h2>
<p>Якори используются для обозначения, что сочетание символов в паттерне обязательно должно начинать или завершать строку. Также есть якори, которые маркируют начало или конец не строки, а слова, однако само определение слова зависит от используемой локали. В R используются следующие якори:</p>
<ul>
<li><p><code>^</code> и <code>$</code>: начало и конец строки соответственно</p></li>
<li><p><code>\\&lt;</code> и <code>\\&gt;</code>: начало и конец слова</p></li>
<li><p><code>\\b</code>: пустая строка или края слова</p></li>
<li><p><code>\\B</code>: не край слова</p></li>
</ul>
<div class="rmdtask">
<p>
Задание: удалите пробелы в начале и в конце <code>victory_song</code>. Используйте логические операторы
</p>
</div>
<!-- Решение:

```r
victory_song <- gsub('^\\s|\\s$', '', victory_song)
```
-->
<div class="rmdtask">
<p>
Выберите все фанфики, у которых имя автора начинается с заглавной латинской буквы. Используйте для этого таблицу без текста фанфиков (тексты очень большие, утяжеляют работу с данными).
</p>
</div>
<!-- Решение:

```r
mass_effect_short[grep('^[A-Z]', author)][1:10]
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["link"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author_link"],"name":[3],"type":["chr"],"align":["left"]},{"label":["author"],"name":[4],"type":["chr"],"align":["left"]},{"label":["page"],"name":[5],"type":["chr"],"align":["left"]},{"label":["fandom"],"name":[6],"type":["chr"],"align":["left"]},{"label":["subtitle"],"name":[7],"type":["chr"],"align":["left"]},{"label":["likes"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"/readfic/5434780?source=premium&premiumVisit=1","2":"Aidu (фанфик переписан)","3":"/authors/7370","4":"Sabi no Kami","5":"1","6":"Mass Effect","7":"Предисловие","8":"161"},{"1":"/readfic/5434780?source=premium&premiumVisit=1","2":"Aidu (фанфик переписан)","3":"/authors/7370","4":"Sabi no Kami","5":"1","6":"Mass Effect","7":"I.I. Vox populi","8":"161"},{"1":"/readfic/5434780?source=premium&premiumVisit=1","2":"Aidu (фанфик переписан)","3":"/authors/7370","4":"Sabi no Kami","5":"1","6":"Mass Effect","7":"I.II. Vox populi","8":"161"},{"1":"/readfic/5434780?source=premium&premiumVisit=1","2":"Aidu (фанфик переписан)","3":"/authors/7370","4":"Sabi no Kami","5":"1","6":"Mass Effect","7":"От автора","8":"161"},{"1":"/readfic/8607023?source=premium&premiumVisit=1","2":"За горизонтом откровений","3":"/authors/3811888","4":"Dillonra","5":"1","6":"Mass Effect","7":"Прерванный отпуск","8":"89"},{"1":"/readfic/8607023?source=premium&premiumVisit=1","2":"За горизонтом откровений","3":"/authors/3811888","4":"Dillonra","5":"1","6":"Mass Effect","7":"Мёртвые созвездия","8":"89"},{"1":"/readfic/9840841?source=premium&premiumVisit=1","2":"Турианская роза","3":"/authors/506335","4":"Nemerethe","5":"1","6":"Mass Effect","7":"-1- Зиртус: Первый контакт","8":"88"},{"1":"/readfic/9840841?source=premium&premiumVisit=1","2":"Турианская роза","3":"/authors/506335","4":"Nemerethe","5":"1","6":"Mass Effect","7":"-2- Зиртус: Интерес","8":"88"},{"1":"/readfic/9840841?source=premium&premiumVisit=1","2":"Турианская роза","3":"/authors/506335","4":"Nemerethe","5":"1","6":"Mass Effect","7":"-3- Зиртус: Внимание","8":"88"},{"1":"/readfic/9840841?source=premium&premiumVisit=1","2":"Турианская роза","3":"/authors/506335","4":"Nemerethe","5":"1","6":"Mass Effect","7":"-4- Зиртус: Мысли","8":"88"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
-->
<div class="rmdtask">
<p>
Выберите с помощью регулярных выражений все фанфики, в который название состоит из одного слова. Используйте регулярные выражения, хотя, конечно, есть и более простые решения.
</p>
</div>
<!-- Решение:

```r
mass_effect_short[grep('^[A-Za-zА-Яа-я0-9]+$', title)][1:10]
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["link"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author_link"],"name":[3],"type":["chr"],"align":["left"]},{"label":["author"],"name":[4],"type":["chr"],"align":["left"]},{"label":["page"],"name":[5],"type":["chr"],"align":["left"]},{"label":["fandom"],"name":[6],"type":["chr"],"align":["left"]},{"label":["subtitle"],"name":[7],"type":["chr"],"align":["left"]},{"label":["likes"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Информация о гг (спойлер)","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Пролог","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 1 (Spore)","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 2","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 3 (Эволюция)","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 4","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 5","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 6","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 7","8":"203"},{"1":"/readfic/10203124","2":"Техномаг","3":"/authors/3728103","4":"Айрэнс","5":"1","6":"Mass Effect","7":"Глава 8","8":"203"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
-->
</div>
<div id="группы" class="section level2" number="3.11">
<h2><span class="header-section-number">3.11</span> Группы</h2>
<p>Квантификаторы обычно работают относительно предыдущего указанного символа. Однако нередко возникают ситуации, когда требуется провести какую-то операцию над определенной группой символов. В таких случаях используют знаки группировки - <code>(</code> и <code>)</code>. Набор символов и/или выражение, заключенные в скобки, будут восприниматься как неразрывная последовательность символов, и обрабатываться соответствующим образом.
Например, если мы хотим удалить из строки строго двукратное повторение группы символов:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="работа-с-регулярными-выражениями.html#cb144-1" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;abRababL&#39;</span>)</span>
<span id="cb144-2"><a href="работа-с-регулярными-выражениями.html#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="работа-с-регулярными-выражениями.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># пробуем удалить пару символов без указания группы</span></span>
<span id="cb144-4"><a href="работа-с-регулярными-выражениями.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;ab&#39;</span>, <span class="st">&#39;_DELETED_&#39;</span>, my_string)</span></code></pre></div>
<pre><code>## [1] &quot;_DELETED_R_DELETED__DELETED_L&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="работа-с-регулярными-выражениями.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># группируем символы с помощью ()</span></span>
<span id="cb146-2"><a href="работа-с-регулярными-выражениями.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;(ab){2}&#39;</span>, <span class="st">&#39;_DELETED_&#39;</span>, my_string)</span></code></pre></div>
<pre><code>## [1] &quot;abR_DELETED_L&quot;</code></pre>
<p>При необходимости всю обрабатываемую строку можно, с помощью символьных классов, групп и прочих инструментов регулярных выражений, представить в паттерне. При подобном представлении группы нумеруются и может быть обработана конкретная группа символов, вызванная по номеру. Номера групп обозначаются как <code>\\1</code>-<code>\\9</code>.</p>
<p>Например:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="работа-с-регулярными-выражениями.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;([a-z]*)-([0-9]*)&#39;</span>, <span class="st">&#39;</span><span class="sc">\\</span><span class="st">1&#39;</span>, <span class="st">&#39;abra-9998&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;abra&quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="работа-с-регулярными-выражениями.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&#39;([a-z]*)-([0-9]*)&#39;</span>, <span class="st">&#39;</span><span class="sc">\\</span><span class="st">2&#39;</span>, <span class="st">&#39;abra-9998&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;9998&quot;</code></pre>
<div class="rmdtask">
<p>
Удалите из названия фанфика текст в скобках, если он идет после собственно названия, используя механизм групп. Например, из <code>Aidu (фанфик переписан)</code> надо сделать <code>Aidu</code>. Проверьте, как выражение работает на строке <code>Открытое письмо от Жорика (он же дредноут «Давящий») автору Архин</code>.
</p>
</div>
<!-- Решение:

```r
pattern <- '^(.*)+\\s+(\\(.*\\))$'
gsub(pattern, '\\1', "Aidu (фанфик переписан)")
```

```
## [1] "Aidu"
```

```r
gsub(pattern, '\\1', "Открытое письмо от Жорика (он же дредноут «Давящий»)  автору Архин")
```

```
## [1] "Открытое письмо от Жорика (он же дредноут «Давящий»)  автору Архин"
```
-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="работа-со-строками.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="сбор-данных-из-интернета-rvest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/2021.02.21-23_icedone/edit/master/02-regular-expressions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
